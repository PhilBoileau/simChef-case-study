**NOTE**: The experiments presented herein are a subset of
[those](https://github.com/PhilBoileau/pub_uniCATE) described in ["A Flexible
Approach for Predictive Biomarker Discovery" (P. Boileau, et al.
2022)](https://arxiv.org/abs/2205.01285). This subset was adapted by the
original author for a case study of the R package
[`simChef`](https://yu-group.github.io/simChef). To reproduce this case study
and documentation, please see the repository
[simChef-case-study](https://github.com/PhilBoileau/simChef-case-study).

### Introduction

An endeavor central to precision medicine is predictive biomarker discovery;
they define patient sub-populations which stand to benefit most, or least, from
a given treatment. The identification of these biomarkers is often the byproduct
of the related but fundamentally different task of treatment rule estimation.
When the number of potentially predictive biomarkers is commensurate with, or
much larger than, the number of observations, the set of biomarkers designated
as predictive by these methods will generally contain many false positives.

In synthetic and real-world data-inspired simulation settings emulating
randomized control trials with high-dimensional covariate vectors, we study a
proposed predictive biomarker discovery method, uniCATE. The objectives of this
simulation study are:

1. Evaluate the proposed method as an estimator of a parameter for directly
   assessing the importance of potentially predictive biomarkers.

2. Examine the empirical behavior, like type-I error rate control, of the
   proposed method as the sample size $n$ grows to determine its correspondence
   to asymptotic results.

3. Study the statistical robustness of the proposed method under a number of
   misspecified nuisance parameter estimator scenarios.

This work is motivated by the need to identify predictive biomarkers in
clinical trials. Of particular interest is their detection for drug target
discovery and diagnostic assay development. The former requires the
identification of biomarkers causally related to the outcome of interest,
whereas the latter seeks a set of strongly predictive biomarkers. This
simulation study is therefore representative of these applications.

### Notation

Consider $n$ identically and independently distributed random vectors $X_i =
(W_i, A_i, Y^{(1)}_i, Y^{(0)}_i) \sim P_X$, $i = 1, \ldots, n$, corresponding
to complete but unobserved data generated by participants in an idealized
randomized control trial or observational study, where:

- $V$: pre-treatment covariates, such as location and income, of dimension $p$.
- $B$: pre-treatment biomarkers, such as gene expression data, of dimension
  $q$.
- $W = (V, B)$: a $(q+p)$-length random vector.
- $A$: a binary random variable representing a treatment assignment.
- $Y^{(1)}$ and $Y^{(0)}$: partially observed random variables corresponding to
  the potential outcomes of clinical interest under both treatment and control
  conditions, respectively, for each patient.
- $P_X$: The unknown data-generating distribution of the full data $(W, A,
  Y^{(0)}, Y^{(1)})$.
- $Y = AY^{(1)} + (1-A)Y^{(0)}$: observed outcomes where $Y_i = Y_i(1)$ if
  patient $i$ received treatment, and $Y_i = Y_i(0)$ otherwise.
- $P_0$: The unknown data-generating distribution of the observed data $(W, A,
  Y)$.
- $P_n$: The observed empirical distribution of a sample of size $n$ drawn from
  $P_0$.

### Clinically predictive biomarker importance parameter

Clinically relevant predictive biomarkers are often those that have a strong
influence on the outcome of interest on the absolute scale. As such, an ideal
target of inference when these outcomes are continuous and the number of
covariates small is the CATE conditioning on the set of biomarkers:

\begin{equation*}
  \mathbb{E}_{P_X}\left[
    Y^{(1)} - Y^{(0)} \big| B = b
  \right].
\end{equation*}

Accurate and interpretable estimation of this parameter is generally challenging
when $p$ is large, preventing the accurate recovery of predictive biomarkers.

Indexing the biomarkers of by $j = 1, \ldots, p$, such that $B = (B_{1},
\ldots, B_{p})$, centering them such that $\mathbb{E}_{P_X}[B_{j}] = 0$, and
assuming that $\mathbb{E}_{P_X}[B^2_{j}] > 0$, we instead target the full-data
variable importance parameter $\Psi^F(P_X) = (\Psi^F_1(P_X), \ldots,
\Psi_p^F(P_X))$ where

\begin{equation*}
  \Psi_{j}^F(P_X) \equiv \frac{\mathbb{E}_{P_X}\left[\left(Y^{(1)} -
    Y^{(0)}\right)B_{j}\right]} {\mathbb{E}_{P_X}\left[B_{j}^2\right]}.
\end{equation*}

Under the assumption that the expected difference in potential outcomes admits a
linear form when conditioning on any given $B_j$, $\Psi^F(P_X)$ is the vector
of expected simple linear regression coefficients produced by regressing the
difference in potential outcomes against each biomarker. While the true
relationship between the difference of potential outcomes and a predictive
biomarker is almost surely nonlinear, $\Psi^F(P_X)$ is a generally informative
target of inference. Biomarkers with the largest absolute values in
$\Psi^F(P_X)$ generally modify the effect of treatment the most.

With assumptions of no unmeasured confounding and overlapping treatment support
in which observations may be assigned to either treatment condition regardless
of covariates, we have

\begin{equation}
  \begin{split}
    \Psi_j(P_0)
    & \equiv \frac{\mathbb{E}_{P_0}\left[\left(\bar{Q}_0(1, W) -
      \bar{Q}_0(0, W)\right)B_{j}\right]}
      {\mathbb{E}_{P_0}\left[B_{j}^2\right]} \\
    & = \Psi_j^F(P_X)
  \end{split}
\end{equation}

where $\bar{Q}_0(a, w) \equiv \mathbb{E}_{P_0}[Y|A = a, W = w]$ is the
conditional expected outcome given treatment and covariates. It follows that
$\Psi(P_0) = \Psi^F(P_X)$ in a randomized control trial.

The parameter $\Psi_j(P_0)$ provides a measure of predictive biomarker importance which is the target of the proposed method, uniCATE, described within.
